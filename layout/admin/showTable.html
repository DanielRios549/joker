<?php
/* 
 ***************************************************************
 | Copyright (c) 2014-2015 Atomo.com. All rights reserved.
 | @ Author	: Daniel Rios.
 ***************************************************************
*/
	if(!isset($baseUrl)) {
		require '../../_redirect.php';
		header("Location:" . $base . "404");
	}
    elseif($adminCheck == true) {
?>
<script type="text/javascript">
	$(document).ready(function() {
		autoPlay = false;
	});
</script>
<div id="managerOptions">
	<a class="managerLink" href="<?php echo $adminDir . langCode('admin_users_add_link');?>"><?php echo langCode('admin_add');?></a>
	<div id="advancedClose" class="searchAdvancedClose"><?php echo langCode('admin_advanced_search');?></div>
</div>
<div id="advancedSearchDiv" class="advancedSearchHide">
	<input type="text" placeholder="Pesquisar por palavra"/>
</div>
<div id="showContents">
<h2 id="contentTotal"><?php echo $foundHeaderText . ' ' . $totalRows . ' ' . $pageType;?></h2>
	<div class="contentSortOption">
		<?php require 'managerOption.html';?>
	</div>
	<div id="contentTable">
		<div id="tableHead">
			<div id="headRow">
				<div id="contentId"><span class="contentSpan"><?php echo '#';?></span></div>
				<div id="contentDetails"><span class="contentSpan"><?php echo 'Details';?></span></div>
				<div id="contentOptions"><span class="contentSpan"><?php echo 'More';?></span></div>
			</div>
		</div>
		<div id="tableBody">
			<?php
			foreach($addRow as $addRow => $key) {
				if($divisorData == true) {
					$episodeDivisor = strpos($key[$cookieLang], "|");
					$thisShowName = substr($key[$cookieLang], 0, $episodeDivisor);
					$thisShowSyn = substr($key[$cookieLang], $episodeDivisor + 1);

					$episodeDivisorUS = strpos($key['en_US'], "|");
					$thisShowNameUS = substr($key['en_US'], 0, $episodeDivisorUS);
					$thisShowSynUS = substr($key['en_US'], $episodeDivisorUS + 1);
					
					$episodeDivisorBR = strpos($key['pt_BR'], "|");
					$thisShowNameBR = substr($key['pt_BR'], 0, $episodeDivisorBR);
					$thisShowSynBR = substr($key['pt_BR'], $episodeDivisorBR + 1);
				}
				else {
					$thisShowName = $key[$current2];
				}
				if ($key[$current1] == $editRow) {
					if(THIS_PAGE == 'admin_users_manager') {
						$currentFolder = $userImageFolder . $editRow;
						$currentImage = $currentFolder . '/profile.jpg';
						$currentCoverImage = $currentFolder . '/cover.jpg';
					}
					elseif(THIS_PAGE == 'admin_movies_manager') {
						$currentFolder = $mediaImageFolder . 'movies/' . $editRow;
						$currentImage = $currentFolder . '/image.jpg';
						$currentCoverImage = $currentFolder . '/background.jpg';
					}
					elseif(THIS_PAGE == 'admin_series_manager') {
						$currentFolder = $mediaImageFolder . 'series/' . $editRow;
						$currentImage = $currentFolder . '/image.jpg';
						$currentCoverImage = $currentFolder . '/background.jpg';
					}
					elseif(THIS_PAGE == 'admin_episodes_manager') {
						$currentFolder = $mediaImageFolder . 'series/' . $key['episode_ref'] . '/season' . $key['season'] . '/episode' . $key['episode'];
						$currentCoverImage = $currentFolder . '/image.jpg';
					}
			?>
			<div id="contentRowChange">
				<div id="closeEditDiv"><a href="<?php echo $setNewUrl;?>" title="Close"></a></div>
				<form class="formAdd" method="post" action="?edited=<?php echo $key[$current1];?>" enctype="multipart/form-data">
					<div class="openFieldset"><span class="openSpan"><?php echo 'Images';?></span></div>
					<fielset class="formFieldset">
						<input type="file" id="userCoverImage" class="fileInput inputImage" accept="image/jpeg">
						<label id="coverImageLabel" for="userCoverImage" class="selectedInputLabel inputImageLabel">
							<figure class="labelFigure">
								<img src="<?php echo $currentCoverImage;?>"/>
								<figcaption class="labelFigcaption"></figcaption>
							</figure>
						</label>
						<?php if(THIS_PAGE != 'admin_episodes_manager') {?>
						<input type="file" id="userImage" class="fileInput inputImage" accept="image/jpeg">
						<label id="imageLabel" for="userImage" class="selectedInputLabel inputImageLabel">
							<figure class="labelFigure">
								<img src="<?php echo $currentImage;?>"/>
								<figcaption class="labelFigcaption"></figcaption>
							</figure>
						</label>
						<?php }?>
					</fielset>
					<?php if((THIS_PAGE != 'admin_users_manager') and (THIS_PAGE != 'admin_series_manager')) {?>
					<div class="openFieldset openFieldsetVideo"><span class="openSpan"><?php echo 'Media';?></span></div>
					<fieldset class="formFieldset">
						<?php
							if(THIS_PAGE == 'admin_movies_manager') {
								$adminContent = $key[$current1];
								$watchLink = getLink('watchMovie', $adminContent);
							}
							elseif(THIS_PAGE == 'admin_episodes_manager') {
								$adminContent = $key[$current2];
								$adminEpisode = $key[$current1];
								$watchLink = getLink('watchSerie', $adminContent) . $adminEpisode;
							}
							require '../includes/watchSettings.php';
						?>
						<div class="linkDiv">
							<a href="<?php echo $watchLink?>" class="link" target="_blank"><?php echo 'Go to Page';?></a>
						</div>
						<div id="watchInterface"
							data-type="<?php echo $contentType;?>"
							data-id="<?php echo $contentId;?>"
							data-season="<?php echo $dataSeason;?>"
							data-episode="<?php echo $dataEpisode;?>"
							data-dash="<?php echo $dashFile;?>"
							data-hls="<?php echo $hlsFile;?>">

							<?php require '../player/' . $videoPlayer . '/player.html';?>
						</div>
					</fieldset>
					<?php }?>
					<fieldset class="formFieldset">
        				<?php require $selectFormFile;?>
					</fieldset>
					<fieldset class="formFieldset">
						<?php
							if(THIS_PAGE == 'admin_users_manager') {
						?>
						<input type="text" id="editName" name="editName" class="inputText" value="<?php echo $key[$current2];?>"/>
						<label for="editName" id="dateLabel" class="inputLabel"></label>
						
						<input type="text" id="editUserName" name="editUserName" class="inputText" value="<?php echo $key[$current3];?>"/>
						<label for="editUserName" id="dateLabel" class="inputLabel"></label>
						
						<input type="text" id="editEmail" name="editEmail" class="inputText" value="<?php echo $key[$current4];?>"/>
						<label for="editEmail" id="dateLabel" class="inputLabel"></label>
						<?php }
							elseif(THIS_PAGE != 'admin_episodes_manager') {
						?>
						<input type="text" id="editProcuder" name="editProcuder" class="inputText" value="<?php echo $key[$current2];?>"/>
						<label for="editProcuder" id="dateLabel" class="inputLabel"></label>
						
						<input type="text" id="editDirector" name="editDirector" class="inputText" value="<?php echo $key[$current3];?>"/>
						<label for="editDirector" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editDate" name="editDate" class="inputText" value="<?php echo $key[$getKeys[10]];?>"/>
						<label for="editDate" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editTitleUS" name="editTitleUS" class="inputText" value="<?php echo $thisShowNameUS;?>"/>
						<label for="editTitleUS" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editSynUS" name="editSynUS" class="inputText" value="<?php echo $thisShowSynUS;?>"/>
						<label for="editSynUS" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editTitleBR" name="editTitleBR" class="inputText" value="<?php echo $thisShowNameBR;?>"/>
						<label for="editTitleBR" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editSynBR" name="editSynBR" class="inputText" value="<?php echo $thisShowSynBR;?>"/>
						<label for="editSynBR" id="dateLabel" class="inputLabel"></label>
						<?php }
							else {
						?>
						<input type="text" id="editTitleUS" name="editTitleUS" class="inputText" value="<?php echo $thisShowNameUS;?>"/>
						<label for="editTitleUS" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editSynUS" name="editSynUS" class="inputText" value="<?php echo $thisShowSynUS;?>"/>
						<label for="editSynUS" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editTitleBR" name="editTitleBR" class="inputText" value="<?php echo $thisShowNameBR;?>"/>
						<label for="editTitleBR" id="dateLabel" class="inputLabel"></label>

						<input type="text" id="editSynBR" name="editSynBR" class="inputText" value="<?php echo $thisShowSynBR;?>"/>
						<label for="editSynBR" id="dateLabel" class="inputLabel"></label>
						<?php }?>
						<button type="submit" class="submitButton"><span class="submitSpan">Save</span></button>
					</fieldset>
				</form>
			</div>
			<?php } elseif($key[$current1] == $removeRow) {?>
			<div id="contentRowChange">
				<div id="closeEditDiv"><a href="<?php echo $setNewUrl;?>" title="Close"></a></div>
				<div id="removeDiv">
					<p class="removeAlert"><?php echo langCode('attention') . '!';?></p>
					<p class="removeAlert"><?php echo langCode('remove_alert');?></p>
					<p class="removeAlert"><?php echo langCode('remove_alternative');?></p>

					<div id="buttonsDiv">
						<a class="deleteButton" href="<?php echo $setNewUrl;?>" title="Close">
							<span class="buttonSpan"><?php echo langCode('settings_cancel');?></span>
						</a>
						<a class="deleteButton removeConfirm" href="?removed=<?php echo $key[$current1];?>" title="Confirm">
							<span class="buttonSpan"><?php echo langCode('confirm');?></span>
						</a>
					</div>
				</div>
			</div>
			<?php } else {?>
			<div class="contentRow">
				<div class="contentId">
					<span class="contentSpan">
						<?php echo $key[$current1];?>
					</span>
				</div>
				<div class="contentDetails">
					<span class="contentSpan">
						<?php echo $thisShowName . " / " . $key[$current3] . " / " . $key[$current4];?>
					</span>
				</div>
				<div class="contentOptions">
					<div class="contentEdit">
						<a href="<?php echo $linkEdit . $key[$current1];?>" data-id="<?php echo $key[$current1];?>" class="contentLink">
							<span>
								<?php echo langCode('admin_edit');?>
							</span>
						</a>
						<a href="<?php echo $linkRemove . $key[$current1];?>" data-id="<?php echo $key[$current1];?>" class="removeOption"></a>
					</div>
				</div>
			</div>
			<?php }}?>
		</div>
	</div>
	<div class="contentSortOption">
		<?php require 'managerOption.html';?>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function() {
		$('.formAdd').on('click', '.openFieldset', function() {
			$(this).toggleClass('fieldsetOpen');
		})
		.on('click', '.openFieldsetVideo', function() {
			if(!video.paused) {
				playPause();
			}
		});
	});
</script>
<?php }?>